---
title: 网络流建模
updated: 2023-03-22 11:40:37Z
created: 2023-03-22 06:15:14Z
latitude: 35.10467400
longitude: 118.35641400
altitude: 0.0000
---

一条边可以看做一个“联系”

比如“种树”题目中，两点之间连一条边表示这两个点被同一棵树占据（一个真正种了树，一个空着避免两树相邻）

比如前K大不相交字段和中，两点之间连边表示将两点“合并起来”，作为一个连续段的某两个相邻元素。

费用流可以看做“选取”，一条边被流到表示一个东西被选取。

费用千万不要赋到和超级源汇直接相连的边上！

“至少覆盖以一次”可以转化成上下界网络流。

# Part 0 拆点

如果“一个点最多只能被流 $x$ 次”，那么可以把这个点拆开，入边连向入点，出边从出点出发，两点之间连一条关于 $x$ 的边。

# Part 1 分层

分层常用于最大流建模中，用以限制“流的长度”。比如家园（网络流24题）中太空飞船的周期、最长不下降子序列（网络流24题）中所有子序列长度相等的限制。这些都可以通过把图分层，让一层连向下一层实现。

这一技巧的本质是把所有流转移到“源点到汇点”的所有路径等长的DAG上。

我们可以利用这一技巧计算“不交最短路”的数量，在最短路并组成的DAG上跑就可以了。

# Part 2 反向

其实就一道题：CQOI2014 危桥

这一道题乍一看可以直接对 $\{a_1,b_1\}\to\{a_2,b_2\}$ 跑一次网络流，但实际上可能出现这种情况：

$$
a_1 \to b_2,cap=b_n\\
b_1 \to a_2,cap=a_n\\
a_n=b_n
$$

或者存在一条边，它被 $a$ 正向流了过去，被 $b$ 反向流了过来，因为我们没有对无向边建立两个【正反二元组】边，所以这条边会被看做没有流。

综合两个原因，我们要把 $b_1,b_2$ 交换过来之后再跑一次最大流。

> 所以，在无向图里面跑网络流的时候一定要小心这种情景。

# Part 3 划分

经典模型：

> 有一个物品集合 $C$，两个可供选择的集合 $A,B$，$C_k$ 放进 $A$ 的代价是 $a_k$，放进 $B$ 的代价是 $b_k$，$C_i,C_j$ 两个物品不在同一个集合里面的代价是 $t_{i,j}$ .

建立超级源点表示 $A$，所有它能到达的默认选进 $A$ 集合，建立超级汇点 $B$，所有与它能到达的表示放入 $B$ 集合。

然后令 $cap(A,C_k) = b_k,cap(C_k,B) = a_k$，因为割掉这条边表示选进对面的集合里面。

最后令 $cap(C_i,C_j) = cap(C_j,C_i) = t_{i,j}$，使得这条边被割掉的时候会付出 $t_{i,j}$ 的代价。**注意这里建立的是无向边**

> 为什么是无向边？因为要考虑 $C_i\in A,C_j\in B$ 和 $C_j\in A,C_i\in B$ 两种情况

> 若 $C_i\in A,C_j\in B$ 时才需要付出代价，从 $C_i$ 向 $C_j$ 连单向边。

划分模型能衍生出来一个更冷门的模型：

# Part 4 串联

参见 [HNOI 2013 切糕]。

这道题本质上也是一种“划分”，把整个切糕按照某种限制分成上下两半