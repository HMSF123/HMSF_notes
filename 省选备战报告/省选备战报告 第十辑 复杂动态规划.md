# Part 0 DP套DP

简单来说，有的DP需要我们构造出满足特定性质的结构，并且我们可以找到一个自动机，按照构建结构的顺序在它上走，就可以判定构造的结构是否合法。

那么我们可以在DP构造结构的同时维护【已经构造完毕的部分】在自动机上走到了哪里，在构造完毕的时候看一下是否走到了自动机上代表合法的点即可。

此外，由于这个自动机一般是由另一个DP过程转化而来，所以又叫DP套DP。

> DP怎么变成自动机？
>
> 考虑一个“判定性”的DP过程，最终的值代表判定的结果。那么：每个状态下的值可以看做一个节点；转移方程可以看做在值之间连边；而状态本身，可以看做一个刻画“判定的过程已经进行了多少”的量。

## [\[CodeChef MAXDTREE\]](https://www.cnblogs.com/Paulliant/p/11730839.html) Max-digit Tree

**题意**：给出按照如下方式构造的无穷序列：

$$
a_i=\begin{dcases}
a_{i-1} + \max_{k\geq 0}\left(\left\lfloor\frac{a_{i-1}}{10^k}\right\rfloor\bmod 10\right) & i\neq 1 \\
1&i=1
\end{dcases}
$$

定义一个值域 $[0,9]$ 序列是合法的，当且仅当直接把这个序列看做一个大整数的十进制数码后，这个大整数位于 $a$ 中。

然后给出一棵树，每个点上有 $0\sim 9$ 的权值，一个连通块合法，当且仅当它包含根节点，并且【其前序遍历形成的权值序列】合法。

对这样的连通块计数。

$n\leq 500$ .

**做法**：首先考虑如何判定一个序列 $b_{1\sim n}$ 是否是合法的。

假设这个序列对应的长整数为 $B$，考虑从 $1$ 递推到 $B$ 的过程中，一共会有 $n-1$ 次面对这样的情况：

$$
b_1b_2\cdots b_m00000\cdots0k
$$

这是因为