---
title: 数数你的同分异构
updated: 2023-04-13 07:23:15Z
created: 2023-04-07 09:42:00Z
latitude: 36.65121600
longitude: 117.12000000
altitude: 0.0000
---

# Part 0 群

## § 0.0 群的基本定义

一个集合 $S$，再加上一个二元运算 $\times$ .（不一定是真的乘法）

如果满足下面的这条性质：

- $\forall x,y\in S,x\times y\in S$（封闭律）

我们称这个集合和这个运算的整体 $(S,\times)$ 构成一个**代数系统**。

如果进一步满足这个性质：

- $\forall x,y,z\in S,(x\times y)\times z = x\times(y\times z)$（结合律）

那么我们还能把这个整体称作一个**半群**。

如果进两步满足这个性质：

- $\exist\, e\in S,\forall\, x\in S,e\times x = x\times e = x$（单位元）

> 注意要对左乘和右乘同时满足这个性质。

那么这个整体可以叫做**幺半群**。

如果进三步满足这个性质：

- $\forall\, x\in S,\exist\, y\in S,x\times y =y\times x = e$（逆元）

> 这里也要同时对左右成立。

那么这个整体就是一个**群**了！

如果在此之上还满足 $\forall\, x,y\in S,x\times y =y\times x$ （交换律），那么这个群叫做**交换群**，或者阿贝尔群。

## § 0.1 置换群

有一些元素 $a_{1},a_2,\cdots,a_n$，定义他们的一个置换为这样的一个映射：

$$
\begin{pmatrix}
a_{p_1} & a_{p_2} & a_{p_3} &\cdots&a_{p_n} \\
a_{1} & a_{2} & a_{3} &\cdots&a_{n} \\
\end{pmatrix}
$$

其中 $p_{1\cdots n}$ 为 $1\sim n$ 的一个排列。

当然，任意交换某些列之后得到的置换和原先的置换是等价的。

两个置换是可以复合的，其定义如下：

$$
\begin{pmatrix}
a_{p_1} & a_{p_2} & a_{p_3} &\cdots&a_{p_n} \\
a_{1} & a_{2} & a_{3} &\cdots&a_{n} \\
\end{pmatrix} \circ
\begin{pmatrix}
a_{1} & a_{2} & a_{3} &\cdots&a_{n} \\
a_{q_1} & a_{q_2} & a_{q_3} &\cdots&a_{q_n} \\
\end{pmatrix} =\\
\begin{pmatrix}
a_{p_1} & a_{p_2} & a_{p_3} &\cdots&a_{p_n} \\
a_{q_1} & a_{q_2} & a_{q_3} &\cdots&a_{q_n} \\
\end{pmatrix}
$$

$n$ 个元素的置换的集合再加上置换的复合操作可以构成一个群，读者自证不难。

定义**循环置换**为一种特殊的置换，满足它可以被写成如下的形式：

$$
\begin{pmatrix}
a_{p_1} & a_{p_2} &\cdots&a_{p_m} & a_{q_1} &\cdots& a_{q_{n-m}} \\
a_{p_2} & a_{p_3} &\cdots&a_{p_1}  & a_{q_1} &\cdots& a_{q_{n-m}} \\
\end{pmatrix}
$$

其中 $p,q$ 两个序列给出 $1\sim n$ 的一个划分。

如果把置换视作图，由一列中上方向下方连边，那么易得到每个点恰有一个出度和一个入度，因此而我们知道这个图是由若干个不相交的环构成的。换句话说，任意一个置换都可以拆成若干循环置换的复合。

## § 0.2 子群与陪集

既然集合有子集，那么群有没有子群呢？

当然有了，子群定义为：有一个群 $G=(S,\times)$，若存在 $T\subseteq S$，且 $(T,\times)$ 是一个群，那么称 $H=(T,\times)$ 为 $G$ 的子群。

> 可以看到，一个子群必定含有大群的单位元。进一步地，我们发现，如果想要证明一个子集 $T$ 和运算 $\times$ 构成一个子群，只需要证明该群具有封闭律、每个元素都有逆元即可。

能不能进一步简化证明呢？我们考虑上面三个要证的东西的实质：

$$
\begin{gathered}
e\in T\\
\forall\, x\in T,x^{-1}\in T \\
\forall x,y\in T,x\times y\in T
\end{gathered}
$$

我们发现，第二个条件比第一个要强一些，满足了他一定会满足第一条，所以把第一条省略掉。

$$
\begin{gathered}
\forall\, x\in T,x^{-1}\in T \\
\forall x,y\in T,x\times y\in T
\end{gathered}
$$

然后这两条条件可以综合为下面的这一条：

$$
\forall x,y\in T,x\times y^{-1}\in T
$$

这是**子群检验定理**，是一个充要条件。

接下来是另一个概念：**陪集**。

> 陪集的由来：考虑四边二面体群 $D_4$（有标号、有正反正方形在空间中的摆放方式群），这个正方形经过一次翻转操作之后，如果不翻转回来，那么它将永远无法回到正面朝上的四个状态。
> 
> 陪集正是为了表征这种性质而发明。

定义 $G$ 的一个子群 $H$ 对于元素 $g\in G$ 的左、右陪集分别为：

$$
\begin{align*}
gH = \{g\times h|h\in H\} \\
Hg = \{h\times g|h\in H\} \\
\end{align*}
$$

**性质 1**：对于某个子群 $H$ 的两个陪集 $fH,gH$，它们要么完全不交，要么完全相同。

证明：假设存在 $h_1$，使得 $gh_1\in fH$，根据陪集的定义，一定存在 $x\in H$，使得 $gh_1 = fx$ .

那么对于任意的 $h_2\in H$，有：

$$
gh_2 = gh_1 h_1^{-1} h_2 = (gh_1)h_1^{-1} h_2 = fxh_1^{-1}h_2
$$

根据子群的封闭律、逆元律，有 $xh_1^{-1}h_2 = h'\in H$，即 $gh_2 = fh' \in H$ .

证毕。

**性质 2**：一个陪集是一个子群当且仅当它与原子群相等。

证明：考虑一个子群必须含有单位元，根据上一性质易证。

**性质 3**：任意一个陪集的大小一定与原子群相等。

证明：假设存在不相同的 $h_1,h_2$，使得 $gh_1 = gh_2$，那么根据逆元律，有 $h_1=h_2$，与题设矛盾。因此不会有两个元素被映射到同一个位置，陪集不会比原子群更小。

同时陪集显然不会比原子群更大。

**性质 4**（拉格朗日定理）：$G$ 的任意一个子群 $H$ 的大小一定整除 $G$ 的大小。

证明：考虑 $H$ 的所有左陪集或右陪集，易证。

> 用记号 $[G:H]$ 表示 $H$ 的不相交的陪集的数目。


## § 0.3 轨道与稳定子

有一个群 $G(S,\circ)$，和一个集合 $X$，现在 $G$ 中有一些可复合的变换，变换的作用对象是 $X$ 中的任意一个元素 $x$，那么我们有如下的两个定义：

$x$ 的**轨道**：定义为 $x$ 经过 $G$ 中的任意几个变换后能变成的所有新元素，即为集合 $\{g(x)|g\in G\}$（因为封闭律，进行一次还是多次变换没有不同）。记作 $G(x)$ .

$x$ 的**稳定子**：定义为 $G$ 中所有施加于 $x$ 后仍得到 $x$ 本身的变换构成的集合。即为 $\{g|g(x) = x,g\in G\}$ 。记作 $G^x$ .

一个性质：$x$ 的稳定子一定是 $G$ 的一个子群。

证明：考虑子群检验定理，设 $a,b\in G^x$，因为 $b(x) = x$，所以有

$$
a\circ b^{-1}(x) = a\circ b^{-1}\circ b(x) = a\circ e(x) = a(x)
$$

而 $a(x) = x$，所以 $a\circ b^{-1}(x) = x$，即 $a\circ b^{-1}\in G^x$

证毕。

然后是**轨道-稳定子定理**，其表述为：

$$
\forall x\in X,|G(x)|\times |G^x| = |G|
$$

证明：考虑刚刚的性质，$G^x$ 一定是一个子群，那么根据拉格朗日定理，我们可以知道

$$
|G^x|\times [G:G^x] = |G|
$$

所以我们想，如果能在 $G^x$ 的陪集与 $G(x)$ 中的元素之间建立一个双射，就可以证明这个定理了。

考虑到 $G(x)$ 里面的元素都是 $g(x)$ 这样的东西，我们利用其中的 $g$ 建立映射，把 $g(x)$ 映射到 $gG^x$ 这个陪集上。

设有轨道中有两个元素 $g(x),f(x)$，那么有如下推导：

$$
\begin{align*}
& gG^x = fG^x \\
\Leftrightarrow & (f^{-1}\circ g)G^x = G^x \\
\Leftrightarrow & f^{-1} \circ g = e \\
\Leftrightarrow & f=g
\end{align*}
$$

因此我们建立的映射是双射。

证毕。

# Part 1 开始计数！

## § 1.0 Burnside计数定理

给定一些立方体，他们的每个面都被染上了某种颜色，计数其中本质不同的立方体数目。

本质不同的立方体是什么？

根据生活常识，两个着色的方案不是本质不同的，当且仅当我们可以通过某种特定的旋转方式，把第一种方案变成第二种。

而一种旋转，可以视作对立方体面的集合进行的一个置换。显然这些置换加上置换复合操作构成一个群 $G$。

然后，我们把一种着色方案视作一个映射，从每一个正方体的面映射到一种特定的颜色，允许有颜色被映射多次，或有颜色不被映射。我们要计数的是在这个置换群 $G$ 的作用下，本质不同的映射数目。

显然，$X$ 中所有能够相互转化的染色方案构成一些连通块，我们把这些连通块记为一些集合 $S_1,S_2,\cdots$，其中的每一个集合我们称为一个等价类。可以证明所有等价类正好构成了 $X$ 的一个划分。暂且记这个性质为性质 A .

另外，可以发现对于等价类里的某个元素，它的**轨道**正好就是这个等价类。记此性质为性质 B .

记 $X//G = {S_1,S_2,\cdots}$ . 而我们要计数的是 $|X//G|$ .

Burnside定理给出：

$$
|X//G| = \frac{1}{ |G| }\sum_{g\in G} |X^{g}|
$$

其中 $X^g$ 表示 $g$ 作用在它上面之后仍得到他自己的 $x\in X$ 的数目。**注意和稳定子不一样！**

证明如下，其中第三行利用了轨道-稳定子定理，第五行利用了等价类的性质 A 将求和分层，第六行利用了等价类的性质 B：

$$
\begin{align}
\sum_{g\in G} X^{g} &= |\{(g,x)|g(x) = x\}| \\
&= \sum_{x\in X} G^x \\
&= \sum_{x\in X} \frac{|G|}{|G(x)|} \\
&= |G|\sum_{x\in X} \frac{1}{|G(x)|} \\
&= |G|\sum_{Y\in (X//G)}~\sum_{x\in Y} \frac{1}{|G(x)|} \\
&= |G|\sum_{Y\in (X//G)}~\sum_{x\in Y} \frac{1}{|Y|} \\
&= |G|\sum_{Y\in (X//G)}1 \\
&= |G|\times|X//G| \\
\end{align}
$$

## § 1.1 Pólya定理

假如我们不是给出若干个已经染好色的立方体，而是让你计数在只用特定几种染料的情况下，有多少种给一个立方体染色的本质不同方案，该如何解决呢？

其实相当于把刚刚的 $X$ 集合改为**所有**由立方体表面的集合 $A$ 向染料集合 $B$ 的映射。

那么这种情况下，$X^g$ 的计算会容易很多。

考虑把这个置换 $g$ 拆成不相交的若干个循环置换，那么一个环中的所有元素都必须涂上同一种颜色。

为什么呢？如果有两个相邻的点颜色不同，进行一次置换（沿循环走一步）之后，一定有一个点被映射到的颜色发生改变。

所以，设置换 $g$ 拆成的循环置换个数为 $\text{loop}(g)$，那么 $X^{g} = |B|^{\text{loop}(g)}$ .

由此得到了 Pólya 定理，其中 $X$ 为所有 $A\to B$ 的映射组成的集合。

$$
|X//G| = \frac{1}{ |G| }\sum_{g\in G} \left||B|^{\text{loop}(g)}\right|
$$

# Part 2 例题

## T1 烷基计数

题意：计数含有 $n$ 个碳原子的烷基的个数。（不考虑空间异构）

解法：本质上就是计数【无标号且任意一个节点的度数不超过四】的有根树的数目。考虑使用生成函数，令 $[x^k]f(x)$ 表示有 $k$ 个碳原子的烷基的个数。

先考虑孩子有序的情况，这是简单的：

$$
F(x) = 1+x(F'(x))^3
$$

然后考虑利用 Burnside 去重，考虑构建一棵有根树，相当于给根的三条朝下的化学键着色，一种颜色就是一种大小的子树，后者的信息保存在上一个迭代的生成函数表达式里。

然后依次考虑对孩子的六种置换，暴力相加。考虑一个置换下某个染色方案不变，只能是每个环都有相同的颜色。

> 但是不能直接用

- $\begin{pmatrix}1&2&3\\1&2&3\end{pmatrix}$ 这种情况相当于 $$