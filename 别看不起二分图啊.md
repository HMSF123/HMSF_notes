---
title: 别看不起二分图啊
updated: 2023-03-23 02:00:25Z
created: 2023-03-22 06:00:13Z
latitude: 35.10467400
longitude: 118.35641400
altitude: 0.0000
---

# Part 0 最大匹配

为了叙述方便，把一种匹配方案中的匹配边称为黑边，未匹配的称为白边。

一条**交错路**定义为黑白交错的路径。

一条**增广路**定义为始终点均为未匹配点的交错路。

显然如果把增广路上的黑白边互换颜色，那么匹配仍然合法，并且大小增加一。

所以我们随便构造一个匹配，然后不停地找增广路，最终无法找到的时候得到的就是最大匹配。

**定理**：如果按照上面的方法，对于图中的每个点，整个过程中从它开始最多寻找一次增广路就可以了。

**证明**：一次增广不会把已匹配点变回未匹配点，只会把路径两端的点变成匹配点，并且增广路只能从未匹配点开始。所以从任意一个点出发最多只需要增广一次。

因此我们得到了最终的算法：依次枚举每一个点。如果他已经是匹配点就跳过；如果是未匹配点就从它开始增广，如果增广成功就把路上的颜色互换。

当然也可以用网络流解决，甚至时间复杂度更为优秀。

还需要记住一个定理：在最大匹配下，所有由未匹配点开始的极长交错路的长度一定是偶数。

# Part 1 最小点覆盖

什么是最小点覆盖？选出一些点，使得每条边至少有一个端点被选到，满足这个条件的最小点集。

**怎么求二分图的最小点覆盖？**

先求出最大匹配，然后找出所有的由**左侧**未匹配点开始的交错路，把这些交错路上的点全部涂上颜色。

然后，最小点覆盖就是**左侧没有**颜色的点和**右侧有**颜色的点。

**如何证明？**

先把所有的点和所有的黑边拿出来，所有黑边不可能有公共点，因此最小点覆盖的大小一定不小于黑边的数量（因为所有黑边都各自需要一个点来覆盖，一个点不可能同时覆盖到两条黑边）。

所以，我们统一在所有黑边的左侧点上放一颗棋子表示该点被覆盖。

然后把白边按照一定的顺序加回去。首先我们把左端是匹配点的白边加回去，这时候棋子是不用移动的，因为这些边一定被其左端点的棋子覆盖。

> 注意，一条白边不可能两端都是未匹配点。

接下来把左端是未匹配点的白边 $(u,v)$ 加进去，这时候它的右端 $v$ 一定是匹配点，我们只需要把【连向 $v$ 的黑边】的左端点上的那颗棋子沿黑边移动到右端点上。

但是这个操作实际上会影响一系列的点，准确地说，以 $(u,v)$ 开始的所有交错路的集合都需要调整。而我们知道这样的交错路长度一定为偶数（见Part0中定理），所以一定可以通过调整黑边上的棋子使得该路径合法。

综上，整个过程中我们只调整棋子，不新增棋子，所以大小得证。然后考虑每次移动棋子相当于所有被交错路经过的右侧节点变成选的，所有没有被交错路经过的左侧节点保留是选的不变。

# Part 2 最大独立集

最大独立集是最小点覆盖的补集。所以可以通过刚刚的方法求，只不过改成**左侧有标记**和**右侧无标记**的点组成的集合。

# Part 3 最小边覆盖

最小边覆盖：每个点的至少一条边被选择的最小集合。

最小边覆盖的补集：每个点至多一条边被选择的最大集合。

等等，这不就是最大匹配吗。

好了，求完了。

