---
title: SAM开悟
updated: 2023-03-16 07:32:59Z
created: 2023-03-15 13:36:48Z
latitude: 35.10467400
longitude: 118.35641400
altitude: 0.0000
---

基本思路：一个更小的串有更多的出现可能

（快速定位子串应用这个思路，每次尝试放弃一部分前缀）

其他的也可以类比，等价类产生的原因是只有放弃了一定阈值的后缀之后，一个串才能在别的地方出现另一次。

> 为什么只放弃前缀不放弃后缀：放弃后缀相当于反悔，但是自动机上不走回头路只走失配路（一路向前不反悔），并且还要保证一个状态只有一种方法能走到。

更巧的是，这个阈值的大小正好能让整个自动机的状态数为线性。

感性理解线性：对于一个小串到处都是的长串（aaaaa这样的）而言，把两个小串组成一个较长串必然牺牲一个位置（放不开了），那些仍然能出现的位置会和小串组成等价类，所以总状态数为线性。

700E定理：等价类内的字串紧紧绑定在一起，如果对于一个节点的串甲而言，有一个串和他绑定紧密，他什么时候出现这个串什么时候出现，并且二串相交保证联通，那么两串的并集理应和甲紧紧绑定、公用终点。

沿转移边走相当于继续扩展，沿链接边走相当于牺牲长度换取灵活性。

700E中牺牲了长度却没有换来灵活性（一旦甲串出现，另一个串必须过去凑一凑），让人怀疑有一个更长的串和甲串本来就长在一起。